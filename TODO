implement batch training
investigate the fault
